2025-05-05 18:27:53,713 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 18:27:53,715 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 18:27:53,717 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 18:27:58,738 - nosql_agent - ERROR - Failed to connect to MongoDB: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 6818b5d10e1807a1f1b47020, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-05-05 18:27:58,738 - locoforge - ERROR - Error in execute_task_node: Could not connect to MongoDB server: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 6818b5d10e1807a1f1b47020, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 34, in __init__
    self.client.server_info()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/mongo_client.py", line 2290, in server_info
    self.admin.command(
    ~~~~~~~~~~~~~~~~~~^
        "buildinfo", read_preference=ReadPreference.PRIMARY, session=session
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ),
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/_csot.py", line 119, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/database.py", line 926, in command
    with self._client._conn_for_reads(read_preference, session, operation=command_name) as (
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/mongo_client.py", line 1864, in _conn_for_reads
    server = self._select_server(read_preference, session, operation)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/mongo_client.py", line 1812, in _select_server
    server = topology.select_server(
        server_selector,
    ...<2 lines>...
        operation_id=operation_id,
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/topology.py", line 409, in select_server
    server = self._select_server(
        selector,
    ...<4 lines>...
        operation_id=operation_id,
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/topology.py", line 387, in _select_server
    servers = self.select_servers(
        selector, operation, server_selection_timeout, address, operation_id
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/topology.py", line 294, in select_servers
    server_descriptions = self._select_servers_loop(
        selector, server_timeout, operation, operation_id, address
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/topology.py", line 344, in _select_servers_loop
    raise ServerSelectionTimeoutError(
        f"{self._error_message(selector)}, Timeout: {timeout}s, Topology Description: {self.description!r}"
    )
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 6818b5d10e1807a1f1b47020, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/main.py", line 80, in execute_task_node
    nosql_agent = GeneralizedNoSQLAgent()
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 42, in __init__
    raise ValueError(f"Could not connect to MongoDB server: {str(e)}")
ValueError: Could not connect to MongoDB server: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 6818b5d10e1807a1f1b47020, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-05-05 18:27:58,744 - locoforge - INFO - Closing database connection
2025-05-05 18:31:45,643 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in drive"
}
2025-05-05 18:31:45,645 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 18:31:45,645 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 18:31:50,659 - nosql_agent - ERROR - Failed to connect to MongoDB: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 6818b6b9620c7454ee9d579d, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-05-05 18:31:50,659 - locoforge - ERROR - Error in execute_task_node: Could not connect to MongoDB server: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 6818b6b9620c7454ee9d579d, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 34, in __init__
    self.client.server_info()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/mongo_client.py", line 2290, in server_info
    self.admin.command(
    ~~~~~~~~~~~~~~~~~~^
        "buildinfo", read_preference=ReadPreference.PRIMARY, session=session
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ),
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/_csot.py", line 119, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/database.py", line 926, in command
    with self._client._conn_for_reads(read_preference, session, operation=command_name) as (
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/mongo_client.py", line 1864, in _conn_for_reads
    server = self._select_server(read_preference, session, operation)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/mongo_client.py", line 1812, in _select_server
    server = topology.select_server(
        server_selector,
    ...<2 lines>...
        operation_id=operation_id,
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/topology.py", line 409, in select_server
    server = self._select_server(
        selector,
    ...<4 lines>...
        operation_id=operation_id,
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/topology.py", line 387, in _select_server
    servers = self.select_servers(
        selector, operation, server_selection_timeout, address, operation_id
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/topology.py", line 294, in select_servers
    server_descriptions = self._select_servers_loop(
        selector, server_timeout, operation, operation_id, address
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/pymongo/synchronous/topology.py", line 344, in _select_servers_loop
    raise ServerSelectionTimeoutError(
        f"{self._error_message(selector)}, Timeout: {timeout}s, Topology Description: {self.description!r}"
    )
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 6818b6b9620c7454ee9d579d, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/main.py", line 80, in execute_task_node
    nosql_agent = GeneralizedNoSQLAgent()
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 42, in __init__
    raise ValueError(f"Could not connect to MongoDB server: {str(e)}")
ValueError: Could not connect to MongoDB server: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 6818b6b9620c7454ee9d579d, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-05-05 18:31:50,667 - locoforge - INFO - Closing database connection
2025-05-05 18:37:24,268 - nosql_query_executer - ERROR - Could not connect to MongoDB server: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 6818b80782cdc05a9c92d860, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
2025-05-05 18:37:24,269 - nosql_query_executer - ERROR - Is MongoDB running on localhost:27017?
2025-05-05 18:38:40,832 - locoforge - INFO - Initializing SQLAgent with database: /Users/yash/Downloads/exercises/LocoForge/sales.db
2025-05-05 18:38:40,832 - locoforge - ERROR - An error occurred in main: unable to open database file
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 99, in main
    agent = SQLAgent("/Users/yash/Downloads/exercises/LocoForge/sales.db")
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 12, in __init__
    self.conn = sqlite3.connect(db_path)
                ~~~~~~~~~~~~~~~^^^^^^^^^
sqlite3.OperationalError: unable to open database file
2025-05-05 18:39:11,181 - locoforge - INFO - Initializing SQLAgent with database: /Users/yash/Downloads/exercises/LocoForge/sales.db
2025-05-05 18:39:11,181 - locoforge - ERROR - An error occurred in main: unable to open database file
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 99, in main
    agent = SQLAgent("/Users/yash/Downloads/exercises/LocoForge/sales.db")
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 12, in __init__
    self.conn = sqlite3.connect(db_path)
                ~~~~~~~~~~~~~~~^^^^^^^^^
sqlite3.OperationalError: unable to open database file
2025-05-05 18:40:18,856 - locoforge - INFO - Initializing SQLAgent with database: /home/aditya/ML/work/LocoForge
2025-05-05 18:40:18,857 - locoforge - ERROR - An error occurred in main: unable to open database file
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 99, in main
    agent = SQLAgent("/home/aditya/ML/work/LocoForge")
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 12, in __init__
    self.conn = sqlite3.connect(db_path)
                ~~~~~~~~~~~~~~~^^^^^^^^^
sqlite3.OperationalError: unable to open database file
2025-05-05 18:40:33,948 - locoforge - INFO - Initializing SQLAgent with database: /home/aditya/ML/work/LocoForge/sales.db
2025-05-05 18:40:33,949 - locoforge - INFO - Executing example queries
2025-05-05 18:40:33,949 - locoforge - INFO - Executing query for prompt: Show me all customers who have ordered more than 5 items in total, along with their total spending
2025-05-05 18:40:50,138 - locoforge - INFO - Query executed successfully. Retrieved 84 rows
2025-05-05 18:40:50,139 - locoforge - INFO - Executing query for prompt: Insert a new record for 2025-05-05 with open=100, high=110, low=95, close=105, volume=1000
2025-05-05 18:40:51,182 - locoforge - ERROR - Error executing query: no such table: Stock_Prices
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 60, in execute_query
    self.cursor.execute(sql_query)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
sqlite3.OperationalError: no such table: Stock_Prices
2025-05-05 18:40:51,183 - locoforge - INFO - Executing query for prompt: Update the record for 2025-05-05 to set volume to 2000
2025-05-05 18:40:51,953 - locoforge - INFO - Query executed successfully. Rows affected: 0
2025-05-05 18:40:51,953 - locoforge - INFO - Executing query for prompt: Delete the record for 2025-05-05
2025-05-05 18:40:52,585 - locoforge - INFO - Query executed successfully. Rows affected: 0
2025-05-05 18:40:52,585 - locoforge - INFO - Closing database connection
2025-05-05 18:59:24,151 - nosql_query_executer - INFO - Successfully connected to MongoDB
2025-05-05 18:59:24,176 - nosql_query_executer - WARNING - Collection dropping disabled for safety. Set ALLOW_DROP_COLLECTIONS=true to enable.
2025-05-05 18:59:35,964 - nosql_query_executer - INFO - Collections dropped based on user confirmation.
2025-05-05 18:59:35,964 - nosql_query_executer - INFO - Generating fake user management data for MongoDB...
2025-05-05 18:59:35,986 - nosql_query_executer - INFO - Inserted 7 roles
2025-05-05 18:59:36,078 - nosql_query_executer - INFO - Inserted batch of 25 users (25/100)
2025-05-05 18:59:36,079 - nosql_query_executer - INFO - Inserted batch of 25 users (50/100)
2025-05-05 18:59:36,081 - nosql_query_executer - INFO - Inserted batch of 25 users (75/100)
2025-05-05 18:59:36,082 - nosql_query_executer - INFO - Inserted batch of 25 users (100/100)
2025-05-05 18:59:36,138 - nosql_query_executer - INFO - Inserted 500 activity logs
2025-05-05 18:59:36,138 - nosql_query_executer - INFO - 
Sample role document:
2025-05-05 18:59:36,139 - nosql_query_executer - INFO - {'_id': ObjectId('6818bd3fed6925023f43fc72'), 'role_id': '335c2796-a9c5-4ff3-a7ca-b8f7c71c135d', 'name': 'Admin', 'description': 'Full system access with all privileges', 'permissions': ['create', 'read', 'update', 'delete', 'manage_users', 'manage_roles'], 'created_at': datetime.datetime(2024, 11, 16, 18, 59, 35, 964000)}
2025-05-05 18:59:36,139 - nosql_query_executer - INFO - 
Sample user document:
2025-05-05 18:59:36,140 - nosql_query_executer - INFO - {'_id': ObjectId('6818bd40ed6925023f43fc79'), 'user_id': '41a54d20-295d-4c42-8935-dfdf6988bab7', 'username': 'barryjohn', 'email': 'william58@example.org', 'password_hash': '80405f38969236a25a1f6993077e138bdd89d4db7447600cfc84e15f3a972470', 'first_name': 'Roberta', 'last_name': 'Stone', 'role_id': '335c2796-a9c5-4ff3-a7ca-b8f7c71c135d', 'role_name': 'Admin', 'department': 'Engineering', 'phone': '725.299.7747', 'address': {'street': '4594 Garcia Center Apt. 587', 'city': 'West Renee', 'state': 'Mississippi', 'zip_code': '55326', 'country': 'Belize'}, 'status': 'Active', 'verified': True, 'created_at': datetime.datetime(2024, 1, 3, 12, 55, 8, 727000), 'last_login': datetime.datetime(2024, 8, 23, 6, 51, 2, 534000), 'profile': {'bio': 'Walk anyone politics.', 'profile_picture': 'https://randomuser.me/api/portraits/women/71.jpg', 'language_preference': 'fr'}, 'settings': {'notifications_enabled': True, 'two_factor_auth': False, 'theme': 'light'}}
2025-05-05 18:59:36,140 - nosql_query_executer - INFO - 
Sample activity log document:
2025-05-05 18:59:36,141 - nosql_query_executer - INFO - {'_id': ObjectId('6818bd40ed6925023f43fcdd'), 'log_id': '01d8907f-ee40-4533-81d8-6f61edf2d72a', 'user_id': 'c850030c-d972-48ce-b83c-e4f1793529a3', 'username': 'john21', 'activity_type': 'failed_login', 'timestamp': datetime.datetime(2024, 9, 16, 3, 57, 50, 405000), 'details': {'ip_address': '21.247.153.173', 'device': 'mobile', 'browser': 'Chrome', 'reason': 'account_locked'}, 'ip_address': '21.247.153.173'}
2025-05-05 18:59:36,141 - nosql_query_executer - INFO - 
Done! MongoDB collections created with fake user management data.
2025-05-05 19:04:29,045 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:04:29,051 - nosql_agent - INFO - Switching to database: test_db
2025-05-05 19:04:29,052 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:04:29,052 - nosql_agent - INFO - Listing all databases
2025-05-05 19:04:41,071 - nosql_agent - INFO - Executing query for prompt: exit
2025-05-05 19:04:41,071 - nosql_agent - INFO - Generating MongoDB query for prompt: exit
2025-05-05 19:04:43,486 - nosql_agent - ERROR - Error generating MongoDB query: Missing required fields in query specification: ['collection', 'operation']
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 362, in _generate_mongo_query
    raise ValueError(f"Missing required fields in query specification: {missing_fields}")
ValueError: Missing required fields in query specification: ['collection', 'operation']
2025-05-05 19:04:43,487 - nosql_agent - ERROR - Error executing query: Missing required fields in query specification: ['collection', 'operation']
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 423, in execute_query
    query_spec = self._generate_mongo_query(prompt)
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 362, in _generate_mongo_query
    raise ValueError(f"Missing required fields in query specification: {missing_fields}")
ValueError: Missing required fields in query specification: ['collection', 'operation']
2025-05-05 19:07:32,550 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:07:32,557 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:07:32,558 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:07:32,558 - nosql_agent - INFO - Listing all databases
2025-05-05 19:07:32,558 - nosql_agent - INFO - Switching to database: test_db
2025-05-05 19:07:32,559 - nosql_agent - INFO - Creating collection: test_collection
2025-05-05 19:07:32,572 - nosql_agent - INFO - Executing query for prompt: Insert a document in test_collection with name='Test User', email='test@example.com', and age=30
2025-05-05 19:07:32,572 - nosql_agent - INFO - Generating MongoDB query for prompt: Insert a document in test_collection with name='Test User', email='test@example.com', and age=30
2025-05-05 19:07:35,512 - nosql_agent - INFO - Insert operation completed. Inserted ID: 6818bf1f0aff8fa09e61aea7
2025-05-05 19:07:35,512 - nosql_agent - INFO - Executing query for prompt: Find all documents in test_collection
2025-05-05 19:07:35,512 - nosql_agent - INFO - Generating MongoDB query for prompt: Find all documents in test_collection
2025-05-05 19:07:36,517 - nosql_agent - INFO - Find operation completed. Found 1 results
2025-05-05 19:07:36,519 - nosql_agent - INFO - Executing query for prompt: Update the document in test_collection where name='Test User' to set status='active'
2025-05-05 19:07:36,519 - nosql_agent - INFO - Generating MongoDB query for prompt: Update the document in test_collection where name='Test User' to set status='active'
2025-05-05 19:07:37,793 - nosql_agent - INFO - Update many operation completed. Modified 1 documents
2025-05-05 19:07:37,793 - nosql_agent - INFO - Executing query for prompt: Find all documents in test_collection where status='active'
2025-05-05 19:07:37,793 - nosql_agent - INFO - Generating MongoDB query for prompt: Find all documents in test_collection where status='active'
2025-05-05 19:07:39,230 - nosql_agent - INFO - Find operation completed. Found 1 results
2025-05-05 19:07:39,231 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:12:49,026 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "nosql",
  "task_type": "query",
  "prompt": "Retrieve the usernames stored in the NoSQL database."
}
2025-05-05 19:12:49,028 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:12:49,028 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:12:49,035 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:12:49,036 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:12:49,715 - locoforge - INFO - Executing task with specification: {
  "agent_type": "nosql",
  "task_type": "query",
  "prompt": "Retrieve the usernames stored in the NoSQL database."
}
2025-05-05 19:12:49,715 - locoforge - INFO - Executing NoSQL agent task
2025-05-05 19:12:49,716 - nosql_agent - INFO - Executing query for prompt: Retrieve the usernames stored in the NoSQL database.
2025-05-05 19:12:49,716 - nosql_agent - INFO - Generating MongoDB query for prompt: Retrieve the usernames stored in the NoSQL database.
2025-05-05 19:12:50,626 - nosql_agent - ERROR - Failed to parse LLM response as JSON: Illegal trailing comma before end of object: line 5 column 17 (char 87)
2025-05-05 19:12:50,626 - nosql_agent - ERROR - Raw response: {
    "collection": "users",
    "operation": "find",
    "query": {},
    "filter": {},
}
2025-05-05 19:12:50,626 - nosql_agent - ERROR - Error generating MongoDB query: Invalid JSON response from LLM
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 348, in _generate_mongo_query
    query_spec = json.loads(response_content)
  File "/usr/lib/python3.13/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/lib/python3.13/json/decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/json/decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Illegal trailing comma before end of object: line 5 column 17 (char 87)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 352, in _generate_mongo_query
    raise ValueError("Invalid JSON response from LLM")
ValueError: Invalid JSON response from LLM
2025-05-05 19:12:50,629 - nosql_agent - ERROR - Error executing query: Invalid JSON response from LLM
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 348, in _generate_mongo_query
    query_spec = json.loads(response_content)
  File "/usr/lib/python3.13/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/lib/python3.13/json/decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/json/decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Illegal trailing comma before end of object: line 5 column 17 (char 87)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 423, in execute_query
    query_spec = self._generate_mongo_query(prompt)
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 352, in _generate_mongo_query
    raise ValueError("Invalid JSON response from LLM")
ValueError: Invalid JSON response from LLM
2025-05-05 19:12:50,631 - locoforge - ERROR - Database error: Error in nosql database: Invalid JSON response from LLM
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/llm_router.py", line 217, in execute_task
    raise DatabaseError(
    ...<2 lines>...
    )
llm_router.DatabaseError: Error in nosql database: Invalid JSON response from LLM
2025-05-05 19:12:50,632 - locoforge - INFO - Closing database connection
2025-05-05 19:12:50,633 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:12:50,636 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:15:39,006 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:15:39,007 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:15:39,008 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:15:39,018 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:15:39,019 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:15:39,020 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:15:39,020 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:15:39,757 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:15:39,791 - locoforge - INFO - Closing database connection
2025-05-05 19:15:39,791 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:17:06,234 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "sql",
  "task_type": "query",
  "prompt": "List all tables in the SQL database"
}
2025-05-05 19:17:06,236 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:17:06,237 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:17:06,244 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:17:06,245 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:17:06,245 - locoforge - INFO - Executing task with specification: {
  "agent_type": "sql",
  "task_type": "query",
  "prompt": "List all tables in the SQL database"
}
2025-05-05 19:17:06,245 - locoforge - INFO - Executing SQL agent task
2025-05-05 19:17:06,245 - locoforge - INFO - Executing query for prompt: List all tables in the SQL database
2025-05-05 19:17:07,360 - locoforge - INFO - Query executed successfully. Retrieved 0 rows
2025-05-05 19:17:07,360 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:17:07,362 - locoforge - INFO - Closing database connection
2025-05-05 19:17:07,363 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:17:07,369 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:17:29,412 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "Find all PDF documents in my Drive"
}
2025-05-05 19:17:29,414 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:17:29,415 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:17:29,424 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:17:29,426 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:17:29,426 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "Find all PDF documents in my Drive"
}
2025-05-05 19:17:29,426 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:17:30,406 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:17:30,408 - locoforge - INFO - Closing database connection
2025-05-05 19:17:30,409 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:19:46,583 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "nosql",
  "task_type": "query",
  "prompt": "List all collections in the MongoDB database."
}
2025-05-05 19:19:46,585 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:19:46,586 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:19:46,592 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:19:46,593 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:19:46,594 - locoforge - INFO - Executing task with specification: {
  "agent_type": "nosql",
  "task_type": "query",
  "prompt": "List all collections in the MongoDB database."
}
2025-05-05 19:19:46,594 - locoforge - INFO - Executing NoSQL agent task
2025-05-05 19:19:46,594 - nosql_agent - INFO - Executing query for prompt: List all collections in the MongoDB database.
2025-05-05 19:19:46,594 - nosql_agent - INFO - Generating MongoDB query for prompt: List all collections in the MongoDB database.
2025-05-05 19:19:54,970 - nosql_agent - INFO - Listing collections in database: user_management_db
2025-05-05 19:19:54,972 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:19:54,974 - locoforge - INFO - Closing database connection
2025-05-05 19:19:54,974 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:19:54,977 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:20:28,452 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "nosql",
  "task_type": "query",
  "prompt": "Find all documents in the users collection"
}
2025-05-05 19:20:28,454 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:20:28,454 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:20:28,461 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:20:28,462 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:20:28,462 - locoforge - INFO - Executing task with specification: {
  "agent_type": "nosql",
  "task_type": "query",
  "prompt": "Find all documents in the users collection"
}
2025-05-05 19:20:28,462 - locoforge - INFO - Executing NoSQL agent task
2025-05-05 19:20:28,462 - nosql_agent - INFO - Executing query for prompt: Find all documents in the users collection
2025-05-05 19:20:28,462 - nosql_agent - INFO - Generating MongoDB query for prompt: Find all documents in the users collection
2025-05-05 19:21:38,384 - nosql_agent - ERROR - Error generating MongoDB query: Connection error.
Traceback (most recent call last):
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    raise exc
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_backends/sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "/usr/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1028)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_base_client.py", line 969, in request
    response = self._client.send(
        request,
        stream=stream or self._should_stream_response_body(request=request),
        **kwargs,
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1028)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 343, in _generate_mongo_query
    response = llm.invoke(messages)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 370, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 947, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 766, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1012, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_openai/chat_models/base.py", line 959, in _generate
    response = self.client.create(**payload)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 925, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<43 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_base_client.py", line 1001, in request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.
2025-05-05 19:21:38,401 - nosql_agent - ERROR - Error executing query: Connection error.
Traceback (most recent call last):
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    raise exc
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_backends/sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "/usr/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1028)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_base_client.py", line 969, in request
    response = self._client.send(
        request,
        stream=stream or self._should_stream_response_body(request=request),
        **kwargs,
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1028)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 423, in execute_query
    query_spec = self._generate_mongo_query(prompt)
  File "/home/aditya/ML/work/LocoForge/src/nosql_agent.py", line 343, in _generate_mongo_query
    response = llm.invoke(messages)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 370, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 947, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 766, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1012, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_openai/chat_models/base.py", line 959, in _generate
    response = self.client.create(**payload)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 925, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<43 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_base_client.py", line 1001, in request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.
2025-05-05 19:21:38,407 - locoforge - ERROR - Database error: Error in nosql database: Connection error.
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/llm_router.py", line 217, in execute_task
    raise DatabaseError(
    ...<2 lines>...
    )
llm_router.DatabaseError: Error in nosql database: Connection error.
2025-05-05 19:21:38,407 - locoforge - INFO - Closing database connection
2025-05-05 19:21:38,407 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:21:38,410 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:23:38,388 - locoforge - ERROR - Unexpected error in task creation: Connection error.
Traceback (most recent call last):
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
        pool_request.request
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    raise exc
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection.py", line 78, in handle_request
    stream = self._connect(request)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_sync/connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_backends/sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "/usr/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1028)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_base_client.py", line 969, in request
    response = self._client.send(
        request,
        stream=stream or self._should_stream_response_body(request=request),
        **kwargs,
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...<2 lines>...
        history=[],
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1028)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/llm_router.py", line 78, in task_creation_agent
    response = llm.invoke(messages)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 370, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 947, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 766, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1012, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/langchain_openai/chat_models/base.py", line 959, in _generate
    response = self.client.create(**payload)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_utils/_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 925, in create
    return self._post(
           ~~~~~~~~~~^
        "/chat/completions",
        ^^^^^^^^^^^^^^^^^^^^
    ...<43 lines>...
        stream_cls=Stream[ChatCompletionChunk],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_base_client.py", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/openai/_base_client.py", line 1001, in request
    raise APIConnectionError(request=request) from err
openai.APIConnectionError: Connection error.
2025-05-05 19:23:38,399 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:25:32,627 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:25:32,629 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:25:32,629 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:25:32,636 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:25:32,636 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:25:32,637 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:25:32,637 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:25:33,357 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:25:33,358 - locoforge - INFO - Closing database connection
2025-05-05 19:25:33,359 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:27:30,165 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:27:30,166 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:27:30,166 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:27:30,175 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:27:30,176 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:27:30,673 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:27:30,673 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:27:32,363 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:27:32,366 - locoforge - INFO - Closing database connection
2025-05-05 19:27:32,367 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:27:32,371 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:28:52,164 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "both",
  "task_type": "query",
  "prompt": "List all the available services you can assist me with."
}
2025-05-05 19:28:52,166 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:28:52,167 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:28:52,175 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:28:52,176 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:28:52,176 - locoforge - INFO - Executing task with specification: {
  "agent_type": "both",
  "task_type": "query",
  "prompt": "List all the available services you can assist me with."
}
2025-05-05 19:28:52,176 - locoforge - INFO - Executing SQL agent task
2025-05-05 19:28:52,176 - locoforge - INFO - Executing query for prompt: List all the available services you can assist me with.
2025-05-05 19:28:53,088 - locoforge - ERROR - Error executing query: no such table: services
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 60, in execute_query
    self.cursor.execute(sql_query)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
sqlite3.OperationalError: no such table: services
2025-05-05 19:28:53,089 - locoforge - INFO - Executing NoSQL agent task
2025-05-05 19:28:53,090 - nosql_agent - INFO - Executing query for prompt: List all the available services you can assist me with.
2025-05-05 19:28:53,090 - nosql_agent - INFO - Generating MongoDB query for prompt: List all the available services you can assist me with.
2025-05-05 19:28:54,625 - nosql_agent - INFO - Listing collections in database: user_management_db
2025-05-05 19:28:54,627 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:28:55,442 - locoforge - ERROR - Database error: Error in sql database: no such table: services
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/llm_router.py", line 217, in execute_task
    raise DatabaseError(
    ...<2 lines>...
    )
llm_router.DatabaseError: Error in sql database: no such table: services
2025-05-05 19:28:55,443 - locoforge - INFO - Closing database connection
2025-05-05 19:28:55,443 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:28:55,445 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:29:36,288 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "both",
  "task_type": "query",
  "prompt": "Check the connection status of all systems"
}
2025-05-05 19:29:36,290 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:29:36,290 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:29:36,300 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:29:36,301 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:29:36,302 - locoforge - INFO - Executing task with specification: {
  "agent_type": "both",
  "task_type": "query",
  "prompt": "Check the connection status of all systems"
}
2025-05-05 19:29:36,302 - locoforge - INFO - Executing SQL agent task
2025-05-05 19:29:36,302 - locoforge - INFO - Executing query for prompt: Check the connection status of all systems
2025-05-05 19:29:36,997 - locoforge - ERROR - Error executing query: no such table: systems
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 60, in execute_query
    self.cursor.execute(sql_query)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
sqlite3.OperationalError: no such table: systems
2025-05-05 19:29:36,998 - locoforge - INFO - Executing NoSQL agent task
2025-05-05 19:29:36,999 - nosql_agent - INFO - Executing query for prompt: Check the connection status of all systems
2025-05-05 19:29:36,999 - nosql_agent - INFO - Generating MongoDB query for prompt: Check the connection status of all systems
2025-05-05 19:29:38,151 - nosql_agent - INFO - Find operation completed. Found 0 results
2025-05-05 19:29:38,151 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:29:39,164 - locoforge - ERROR - Database error: Error in sql database: no such table: systems
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/llm_router.py", line 217, in execute_task
    raise DatabaseError(
    ...<2 lines>...
    )
llm_router.DatabaseError: Error in sql database: no such table: systems
2025-05-05 19:29:39,166 - locoforge - INFO - Closing database connection
2025-05-05 19:29:39,167 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:29:39,171 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:30:26,913 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "nosql",
  "task_type": "query",
  "prompt": "Fetch all the users who have Admin as their role_name in MongoDB"
}
2025-05-05 19:30:26,914 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:30:26,914 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:30:26,920 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:30:26,921 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:30:26,921 - locoforge - INFO - Executing task with specification: {
  "agent_type": "nosql",
  "task_type": "query",
  "prompt": "Fetch all the users who have Admin as their role_name in MongoDB"
}
2025-05-05 19:30:26,921 - locoforge - INFO - Executing NoSQL agent task
2025-05-05 19:30:26,921 - nosql_agent - INFO - Executing query for prompt: Fetch all the users who have Admin as their role_name in MongoDB
2025-05-05 19:30:26,921 - nosql_agent - INFO - Generating MongoDB query for prompt: Fetch all the users who have Admin as their role_name in MongoDB
2025-05-05 19:30:27,943 - nosql_agent - INFO - Find operation completed. Found 9 results
2025-05-05 19:30:27,943 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:30:27,945 - locoforge - INFO - Closing database connection
2025-05-05 19:30:27,946 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:30:27,948 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:31:24,191 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "insert",
  "prompt": "Create a new folder called 'LocoForge Project' in my Drive"
}
2025-05-05 19:31:24,193 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:31:24,194 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:31:24,200 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:31:24,201 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:31:24,201 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "insert",
  "prompt": "Create a new folder called 'LocoForge Project' in my Drive"
}
2025-05-05 19:31:24,201 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:31:25,013 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:31:25,014 - locoforge - INFO - Closing database connection
2025-05-05 19:31:25,014 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:31:25,017 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:38:58,436 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "insert",
  "prompt": "Create a folder named LocoForge demo"
}
2025-05-05 19:38:58,437 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:38:58,437 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:38:58,443 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:38:58,443 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:38:58,826 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "insert",
  "prompt": "Create a folder named LocoForge demo"
}
2025-05-05 19:38:58,826 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:39:06,633 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:39:06,637 - locoforge - INFO - Closing database connection
2025-05-05 19:39:06,637 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:39:06,642 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:41:26,318 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "delete",
  "prompt": "Delete a folder named LocoForge demo"
}
2025-05-05 19:41:26,320 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:41:26,320 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:41:26,327 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:41:26,327 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:41:26,328 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "delete",
  "prompt": "Delete a folder named LocoForge demo"
}
2025-05-05 19:41:26,328 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:41:27,240 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:41:27,241 - locoforge - INFO - Closing database connection
2025-05-05 19:41:27,241 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:41:27,244 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:45:24,492 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "insert",
  "prompt": "create a folder named aditya in Google Drive"
}
2025-05-05 19:45:24,494 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:45:24,495 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:45:24,505 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:45:24,507 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:45:29,017 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "insert",
  "prompt": "create a folder named aditya in Google Drive"
}
2025-05-05 19:45:29,018 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:45:44,467 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:45:44,471 - locoforge - INFO - Closing database connection
2025-05-05 19:45:44,471 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:46:54,010 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "insert",
  "prompt": "Create a new folder named aditya in Google Drive"
}
2025-05-05 19:46:54,012 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:46:54,013 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:46:54,023 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:46:54,024 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:46:54,517 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "insert",
  "prompt": "Create a new folder named aditya in Google Drive"
}
2025-05-05 19:46:54,517 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:46:56,452 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:46:56,455 - locoforge - INFO - Closing database connection
2025-05-05 19:46:56,456 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:46:56,459 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:47:20,280 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:47:20,282 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:47:20,283 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:47:20,290 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:47:20,291 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:47:20,291 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:47:20,291 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:47:22,347 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:47:22,348 - locoforge - INFO - Closing database connection
2025-05-05 19:47:22,348 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:47:22,350 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:47:48,473 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "delete",
  "prompt": "Delete a folder named aditya in Google Drive"
}
2025-05-05 19:47:48,475 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:47:48,475 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:47:48,481 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:47:48,482 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:47:48,482 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "delete",
  "prompt": "Delete a folder named aditya in Google Drive"
}
2025-05-05 19:47:48,482 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:47:50,213 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:47:50,215 - locoforge - INFO - Closing database connection
2025-05-05 19:47:50,215 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:47:50,219 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:48:44,078 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "delete",
  "prompt": "Delete a folder with id \"1XNAwjrvQUmo2P6LBSt8AEBNdmOuvoVln\" in Google Drive"
}
2025-05-05 19:48:44,079 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:48:44,080 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:48:44,087 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:48:44,088 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:48:44,088 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "delete",
  "prompt": "Delete a folder with id \"1XNAwjrvQUmo2P6LBSt8AEBNdmOuvoVln\" in Google Drive"
}
2025-05-05 19:48:44,088 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:48:46,740 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:48:46,742 - locoforge - INFO - Closing database connection
2025-05-05 19:48:46,742 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:48:46,746 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:49:32,513 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "both",
  "task_type": "query",
  "prompt": "Retrieve data associated with the ID '1XNAwjrvQUmo2P6LBSt8AEBNdmOuvoVln'"
}
2025-05-05 19:49:32,515 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:49:32,515 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:49:32,522 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:49:32,523 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:49:32,523 - locoforge - INFO - Executing task with specification: {
  "agent_type": "both",
  "task_type": "query",
  "prompt": "Retrieve data associated with the ID '1XNAwjrvQUmo2P6LBSt8AEBNdmOuvoVln'"
}
2025-05-05 19:49:32,523 - locoforge - INFO - Executing SQL agent task
2025-05-05 19:49:32,523 - locoforge - INFO - Executing query for prompt: Retrieve data associated with the ID '1XNAwjrvQUmo2P6LBSt8AEBNdmOuvoVln'
2025-05-05 19:49:33,539 - locoforge - ERROR - Error executing query: no such table: your_table_name
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 60, in execute_query
    self.cursor.execute(sql_query)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
sqlite3.OperationalError: no such table: your_table_name
2025-05-05 19:49:33,540 - locoforge - INFO - Executing NoSQL agent task
2025-05-05 19:49:33,540 - nosql_agent - INFO - Executing query for prompt: Retrieve data associated with the ID '1XNAwjrvQUmo2P6LBSt8AEBNdmOuvoVln'
2025-05-05 19:49:33,540 - nosql_agent - INFO - Generating MongoDB query for prompt: Retrieve data associated with the ID '1XNAwjrvQUmo2P6LBSt8AEBNdmOuvoVln'
2025-05-05 19:49:34,565 - nosql_agent - INFO - Find operation completed. Found 0 results
2025-05-05 19:49:34,565 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:49:35,895 - locoforge - ERROR - Database error: Error in sql database: no such table: your_table_name
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/google_drive_ops.py", line 900, in execute_command
    result = await self.drive.download_file(**drive_command.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aditya/ML/work/LocoForge/src/google_drive_ops.py", line 324, in download_file
    file_metadata = await self._run_in_thread(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/home/aditya/ML/work/LocoForge/src/google_drive_ops.py", line 170, in _run_in_thread
    return await loop.run_in_executor(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/usr/lib/python3.13/asyncio/futures.py", line 286, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.13/asyncio/tasks.py", line 375, in __wakeup
    future.result()
    ~~~~~~~~~~~~~^^
  File "/usr/lib/python3.13/asyncio/futures.py", line 199, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/googleapiclient/_helpers.py", line 134, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/home/aditya/ML/work_venv/lib/python3.13/site-packages/googleapiclient/http.py", line 935, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 404 when requesting https://www.googleapis.com/drive/v3/files/1XNAwjrvQUmo2P6LBSt8AEBNdmOuvoVln?fields=name%2CmimeType%2Csize&alt=json returned "File not found: 1XNAwjrvQUmo2P6LBSt8AEBNdmOuvoVln.". Details: "[{'message': 'File not found: 1XNAwjrvQUmo2P6LBSt8AEBNdmOuvoVln.', 'domain': 'global', 'reason': 'notFound', 'location': 'fileId', 'locationType': 'parameter'}]">

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/llm_router.py", line 217, in execute_task
    raise DatabaseError(
    ...<2 lines>...
    )
llm_router.DatabaseError: Error in sql database: no such table: your_table_name
2025-05-05 19:49:35,897 - locoforge - INFO - Closing database connection
2025-05-05 19:49:35,897 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:49:35,900 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:50:47,676 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:50:47,678 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:50:47,678 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:50:47,685 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:50:47,687 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:50:47,687 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:50:47,687 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:50:48,802 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:50:48,804 - locoforge - INFO - Closing database connection
2025-05-05 19:50:48,805 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:50:48,810 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:52:06,420 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "delete",
  "prompt": "Delete a folder with id '12javNqdJpB6nONmxUkuGF3hzGxs8ZtZA' in Google Drive"
}
2025-05-05 19:52:06,422 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:52:06,423 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:52:06,432 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:52:06,434 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:52:06,434 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "delete",
  "prompt": "Delete a folder with id '12javNqdJpB6nONmxUkuGF3hzGxs8ZtZA' in Google Drive"
}
2025-05-05 19:52:06,434 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:52:08,935 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:52:08,937 - locoforge - INFO - Closing database connection
2025-05-05 19:52:08,938 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:52:08,943 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:52:36,827 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:52:36,829 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:52:36,829 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:52:36,838 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:52:36,839 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:52:36,839 - locoforge - INFO - Executing task with specification: {
  "agent_type": "drive",
  "task_type": "query",
  "prompt": "List all files in my Google Drive"
}
2025-05-05 19:52:36,840 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:52:38,370 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:52:38,373 - locoforge - INFO - Closing database connection
2025-05-05 19:52:38,373 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:52:38,377 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:55:20,808 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "both",
  "task_type": "query",
  "prompt": "Retrieve all the table names in both SQL and NoSQL databases"
}
2025-05-05 19:55:20,810 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:55:20,810 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:55:20,820 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:55:20,821 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:55:20,822 - locoforge - INFO - Executing task with specification: {
  "agent_type": "both",
  "task_type": "query",
  "prompt": "Retrieve all the table names in both SQL and NoSQL databases"
}
2025-05-05 19:55:20,822 - locoforge - INFO - Executing SQL agent task
2025-05-05 19:55:20,822 - locoforge - INFO - Executing query for prompt: Retrieve all the table names in both SQL and NoSQL databases
2025-05-05 19:55:21,635 - locoforge - ERROR - Error executing query: near "```sql
SELECT name as table_name FROM sqlite_master WHERE type ='table';
```": syntax error
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/sql_agent.py", line 60, in execute_query
    self.cursor.execute(sql_query)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
sqlite3.OperationalError: near "```sql
SELECT name as table_name FROM sqlite_master WHERE type ='table';
```": syntax error
2025-05-05 19:55:21,636 - locoforge - INFO - Executing NoSQL agent task
2025-05-05 19:55:21,636 - nosql_agent - INFO - Executing query for prompt: Retrieve all the table names in both SQL and NoSQL databases
2025-05-05 19:55:21,636 - nosql_agent - INFO - Generating MongoDB query for prompt: Retrieve all the table names in both SQL and NoSQL databases
2025-05-05 19:55:25,250 - nosql_agent - INFO - Listing collections in database: user_management_db
2025-05-05 19:55:25,252 - locoforge - INFO - Executing Google Drive agent task
2025-05-05 19:55:26,747 - locoforge - ERROR - Database error: Invalid query syntax in sql database
Traceback (most recent call last):
  File "/home/aditya/ML/work/LocoForge/src/llm_router.py", line 205, in execute_task
    raise DatabaseError(
    ...<2 lines>...
    )
llm_router.DatabaseError: Invalid query syntax in sql database
2025-05-05 19:55:26,749 - locoforge - INFO - Closing database connection
2025-05-05 19:55:26,749 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:55:26,754 - locoforge - INFO - Drive agent resources cleaned up
2025-05-05 19:56:41,064 - locoforge - INFO - Successfully created task specification: {
  "agent_type": "nosql",
  "task_type": "query",
  "prompt": "Retrieve all the user names from the NoSQL database."
}
2025-05-05 19:56:41,066 - locoforge - INFO - Initializing SQLAgent with database: sales.db
2025-05-05 19:56:41,067 - nosql_agent - INFO - Initializing Generalized NoSQL agent with connection string: mongodb://localhost:27017/
2025-05-05 19:56:41,078 - nosql_agent - INFO - Switching to database: user_management_db
2025-05-05 19:56:41,080 - nosql_agent - INFO - Generalized NoSQL agent initialized successfully
2025-05-05 19:56:41,080 - locoforge - INFO - Executing task with specification: {
  "agent_type": "nosql",
  "task_type": "query",
  "prompt": "Retrieve all the user names from the NoSQL database."
}
2025-05-05 19:56:41,080 - locoforge - INFO - Executing NoSQL agent task
2025-05-05 19:56:41,080 - nosql_agent - INFO - Executing query for prompt: Retrieve all the user names from the NoSQL database.
2025-05-05 19:56:41,080 - nosql_agent - INFO - Generating MongoDB query for prompt: Retrieve all the user names from the NoSQL database.
2025-05-05 19:56:42,015 - nosql_agent - INFO - Find operation completed. Found 100 results
2025-05-05 19:56:42,016 - locoforge - INFO - Task execution completed successfully
2025-05-05 19:56:42,018 - locoforge - INFO - Closing database connection
2025-05-05 19:56:42,018 - nosql_agent - INFO - Closing MongoDB connection
2025-05-05 19:56:42,022 - locoforge - INFO - Drive agent resources cleaned up
